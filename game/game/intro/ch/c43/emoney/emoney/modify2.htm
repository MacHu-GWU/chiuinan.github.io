<html>
<head>
<meta http-equiv=Content-Type content=text/html; charset=utf-8>
<title>資訊修改</title>
</head>
<body>
<pre>
<font face=細明體 size=3><CENTER><FONT COLOR=FF0000 size=5><b>資訊修改</b></FONT></CENTER>
<font color=blue><b>一、總體資料</b></font>

1.PAL1.TAB：內定256色調色盤，依次為RGB，最大值3Fh


2.MONEY.DDT：資訊集結檔（之後的檔案均集結在此檔裡）

檔案數目：4 byte
檔案指示資訊：每個16 byte
  檔名：12 byte，可能不含NULL字元，最後一個為"---.---"，不使用
  檔案內容開始位置：4 byte，由前後位置可得知檔案內容大小
各檔案內容


<font color=blue><b>二、圖像部份</b></font>

1.CMP影像檔

水平大小：2 byte
垂直大小：2 byte
影像資料：<A href="#cmp">256色CMP影像壓縮資料</A>
調色盤資料（不一定有）：256x3 byte，依次為rgb，最大值3Fh


2.ICO圖像集（ITEM.ICO各物品圖為48x48，其餘與地圖有關的均為64x80）

影像資料：<A href="#ico">256色ICO影像資料</A>（不一定壓縮），由TYP圖像指標檔指向


3.TYP圖像指標檔：指向ICO圖像集

指標資訊：8 byte一組
  影像資料大小：4 byte，若與原始影像資料大小相同，表示影像資料未壓縮
  影像資料開始位置：4 byte


<font color=blue><b>三、地圖資料部份</b></font>

1.MAP0?.MAP：地圖地形資料檔

地圖實際水平大小：4 byte
地圖實際垂直大小：4 byte
地圖地形資料編號：2 byte一個，共64x64個，分別指向MAP0?.ICO的第幾個圖
地圖初始顯示左上角位置x,y：各4 byte


2.MAP0?.CHG：地形意義檔

地形意義編號：每個4 byte，對應各地形資料編號實際的意義編號。請參見<A href="place.htm">地點列表</A>。
處理的跳越分支程式在1DE4B5h，使用的分支位址記憶體在1DE3C1h。


3.MAP0?.CHR：各章人物初值，格式請參見<A href="save.htm#1">存檔修改</A>


4.MAP0?.DAT：各章領地初值，格式請參見<A href="save.htm#2">存檔修改</A>

(1)各角色主城的填入，係找領地位置對應的地形資料編號（MAP0?.MAP），再轉譯為地形意
   義編號（MAP0?.CHG），找出為E6h～E9h者
(2)領地守軍在進入章節時，自動隨機產生，人數與等級請參見各地圖之說明（相關資料在
   MONEY.EXE裡）


<font color=blue><b>四、非地圖資料部份</b></font>

1.ITEM.DAT：物品資訊檔，每個2Ah=42 byte

0000h 物品編號：4 byte
0004h 物品名稱：12 byte
0010h 物品形態：1 byte，1=武器，2=衣服，3=盾牌…
0011h 允許裝備人員：1 byte，08h=希洛，04h=明，02h=凱麗，01h=雪莉
0012h AP增值：4 byte
0016h HIT準確度：4 byte
001Ah DP增值：4 byte
001Eh EV增值：4 byte
0022h 價格：4 byte
0026h 商店可買賣的關卡：4 byte，08h=第1關，04h=第2關，02h=第3關，01h=第4關

註：道具與卡片的用途是直接寫死在程式裡，無法由此資訊檔變更。


2.SPELL.DAT：主角法術資訊檔，每個14h=20 byte

0000h 主角法術編號：4 byte
0004h 主角法術名稱：12 byte

本檔案資料不使用，實際對應至怪物法術編號=主角法術編號+50(32h)


3.SPELL2.DAT：怪物法術資訊檔，每個15h=21 byte

0000h 怪物法術編號：4 byte
0004h 怪物法術名稱：12 byte
0010h 法術型態：1 byte
        00 物理  01 火系  02 冰系  03 雷系  04 法術
        05 毒    06 炎    07 冰    08 特殊  0A 醫療
0011h 對象：1 byte，0=我方，1=敵方，5=我方狀態
0012h 範圍：1 byte，0=全部，1=單人，2=自己
0013h 不明：1 byte
0014h 耗用法力：1 byte

註：各法術的實際作用均直接寫死在程式裡，分支資訊在EMONEY.EXE位置033018h處，實際
    記憶體在1EF618h，跳越分支程式在1EF78Ah。法術編號0即一般攻擊。


4.MONSTER.DAT：怪物資訊檔，每個AAh=170 byte

0000h 怪物編號：4 byte
0004h 怪物名稱：14 byte
0010h 不明：2 byte
0012h 記號字串：4 byte (只有2 byte英文字母)
0016h 怪物類別：4 byte，0=人類，1=類人族，2=獸類，3=魔族
001Ah 不明：4 byte
001Eh 等級：4 byte
0022h 生命：12 byte，目前生命、H1、H0，最大生命=H1+H0*(LV-1)
002Eh 法力：12 byte，目前法力、M1、M0，最大法力=M1+M0*(LV-1)
003Ah AP：8 byte，AP1、AP0 = AP1+AP0*(LV-1)
0042h HIT：8 byte，HIT1、HIT0 = HIT1+HIT0*(LV-1)
004Ah 提供的經驗值：8 byte，EXP1、EXP0 = EXP1+EXP0*(LV-1)
0052h 不明：4 byte
0056h 實際AP：4 byte = AP
005Ah 實際準確度：4 byte = HIT+附加HIT
005Eh 實際DP：4 byte = AP/2
0062h 實際EV：4 byte = HIT/2+附加EV
0066h 一般攻擊次數：4 byte，1=一次，2=兩次，5=攻擊全體
006Ah 附加HIT：4 byte
006Eh 附加EV：4 byte
0072h 法術編號：3x4 byte，0表沒有
007Eh 施展法術的最低等級：3x4 byte
008Ah 不明：4 byte
008Eh 種族相性編號：4 byte
0092h 每等級雇用價格／掉落金錢：4 byte，實際價格=價格*10*LV
0096h 每等級經驗值：4 byte
009Ah 可偷物品編號：4 byte
009Eh 不明：4 byte
00A2h 體型：4 byte，1=小，2以上為大
00A6h 倍力(APx2)狀態旗標：1 byte
00A7h 鐵壁(DPx2)狀態旗標：1 byte
00A8h 隱身/虛幻(EVx2)狀態旗標：1 byte
00A9h 必中(HITx2)狀態旗標：1 byte


5.GROUP.DAT：種族相性表，每個34h=52 byte

種族編號：4 byte
種族名稱：12 byte
相性：9x4 byte整數，依次代表相性：物理、火系、冰系、雷系、法術、毒、炎、冰、特殊

註：實際相性資料寫死在程式中（MONEY.EXE位置085B10h），不使用此檔之相性資料


<A name=cmp><font color=blue><b>*** 256色CMP影像資料解壓法</b></font>

b = 讀取1 byte
if (b == 0) // 透明 //
{
  n = 讀取1 byte
  x += n
}
else if (b == 1)
{
  n = 讀取1 byte
  b = 讀取1 byte
  輸出b共n次
}
else if (b == 2)
{
  n = 讀取1 byte
  讀取並輸出n byte資料
}
else if ((b >= 3) && (b <= 6))
{
  n = 讀取1 byte
  讀取並輸出n*4+b-3 byte資料
}
else if (b == 0xFF)
{
  換下一行影像
  if 影像已滿 then 結束
}

<A name=ico><font color=blue><b>*** 256色ICO影像資料解壓法</b></font>

b = 讀取1 byte
if (b == 0)
{
  n = 讀取1 byte
  輸出0共n次
}
else if (b == 1)
{
  n = 讀取1 byte
  b = 讀取1 byte
  輸出b共n次
}
else if (b == 2)
{
  n = 讀取1 byte
  讀取並輸出n byte資料
}
else if ((b >= 3) && (b <= 6))
{
  n = 讀取1 byte
  讀取並輸出n*4+b-3 byte資料
}
else if (b == 0xFF)
{
  換下一行影像
  if 影像已滿 then 結束
}
</font>
</pre>
</body>
</html>
